#axis.title.x = element_blank(),
legend.position='none') +
coord_flip() +
scale_fill_manual(values = c("#92c5de", "red")) +
#labs(title="Number of cells in each sample (Singlets)", x ="Samples", y = "Number of Cells")
labs(title=paste0("Data da contagem: ", date_value), x ="Participantes", y = "Numero de respostas")
##### Rankig
ggplot(res, aes(reorder(Name, -Counts, sum), Counts, fill=Tipo)) +
geom_col() +
geom_text(
aes(label = stat(y), group = Name),
stat = 'summary', fun.y = sum, hjust = -2, size = 8
) +
#geom_bar(position="stack", stat="identity") +
theme_minimal(base_size = 20) +
geom_text(data=subset(res, Counts != 0), aes(label = Counts), size = 8, position = position_stack(0.5)) +
theme(plot.title = element_text(hjust = 0.5),
#axis.text.x = element_text(angle = 45, hjust = 1),
#axis.title.x = element_blank(),
legend.position='none') +
coord_flip() +
scale_fill_manual(values = c("#92c5de", "red")) +
#labs(title="Number of cells in each sample (Singlets)", x ="Samples", y = "Number of Cells")
labs(title=paste0("Data da contagem: ", date_value), x ="Participantes", y = "Numero de respostas")
ggplot(res, aes(reorder(Name, -Counts, sum), Counts, fill=Tipo)) +
geom_col() +
geom_text(
aes(label = stat(y), group = Name),
stat = 'summary', fun.y = sum, hjust = -1, size = 8
) +
#geom_bar(position="stack", stat="identity") +
theme_minimal(base_size = 20) +
geom_text(data=subset(res, Counts != 0), aes(label = Counts), size = 8, position = position_stack(0.5)) +
theme(plot.title = element_text(hjust = 0.5),
#axis.text.x = element_text(angle = 45, hjust = 1),
#axis.title.x = element_blank(),
legend.position='none') +
coord_flip() +
scale_fill_manual(values = c("#92c5de", "red")) +
#labs(title="Number of cells in each sample (Singlets)", x ="Samples", y = "Number of Cells")
labs(title=paste0("Data da contagem: ", date_value), x ="Participantes", y = "Numero de respostas")
ggplot(res, aes(reorder(Name, -Counts, sum), Counts, fill=Tipo)) +
geom_col() +
geom_text(
aes(label = stat(y), group = Name),
stat = 'summary', fun.y = sum, hjust = -.5, size = 8
) +
#geom_bar(position="stack", stat="identity") +
theme_minimal(base_size = 20) +
geom_text(data=subset(res, Counts != 0), aes(label = Counts), size = 8, position = position_stack(0.5)) +
theme(plot.title = element_text(hjust = 0.5),
#axis.text.x = element_text(angle = 45, hjust = 1),
#axis.title.x = element_blank(),
legend.position='none') +
coord_flip() +
scale_fill_manual(values = c("#92c5de", "red")) +
#labs(title="Number of cells in each sample (Singlets)", x ="Samples", y = "Number of Cells")
labs(title=paste0("Data da contagem: ", date_value), x ="Participantes", y = "Numero de respostas")
ggplot(res, aes(reorder(Name, -Counts, sum), Counts, fill=Tipo)) +
geom_col() +
geom_text(
aes(label = stat(y), group = Name),
stat = 'summary', fun.y = sum, hjust = -.5, size = 8
) +
#geom_bar(position="stack", stat="identity") +
theme_minimal(base_size = 20) +
geom_text(data=subset(res, Counts != 0), aes(label = Counts), size = 8, position = position_stack(0.5)) +
theme(plot.title = element_text(hjust = 0.5),
#axis.text.x = element_text(angle = 45, hjust = 1),
#axis.title.x = element_blank(),
legend.position='none') +
coord_flip() +
coord_cartesian(clip = "off") +
scale_fill_manual(values = c("#92c5de", "red")) +
#labs(title="Number of cells in each sample (Singlets)", x ="Samples", y = "Number of Cells")
labs(title=paste0("Data da contagem: ", date_value), x ="Participantes", y = "Numero de respostas")
ggplot(res, aes(reorder(Name, -Counts, sum), Counts, fill=Tipo)) +
geom_col() +
geom_text(
aes(label = stat(y), group = Name),
stat = 'summary', fun.y = sum, hjust = -.5, size = 8
) +
#geom_bar(position="stack", stat="identity") +
theme_minimal(base_size = 20) +
geom_text(data=subset(res, Counts != 0), aes(label = Counts), size = 8, position = position_stack(0.5)) +
theme(plot.title = element_text(hjust = 0.5),
#axis.text.x = element_text(angle = 45, hjust = 1),
#axis.title.x = element_blank(),
legend.position='none') +
coord_flip() +
scale_fill_manual(values = c("#92c5de", "red")) +
#labs(title="Number of cells in each sample (Singlets)", x ="Samples", y = "Number of Cells")
labs(title=paste0("Data da contagem: ", date_value), x ="Participantes", y = "Numero de respostas")
##### Rankig
ggplot(res, aes(reorder(Name, -Counts, sum), Counts, fill=Tipo)) +
geom_col() +
geom_text(
aes(label = stat(y), group = Name),
stat = 'summary', fun.y = sum, hjust="inward", hjust = -.5, size = 8
) +
#geom_bar(position="stack", stat="identity") +
theme_minimal(base_size = 20) +
geom_text(data=subset(res, Counts != 0), aes(label = Counts), size = 8, position = position_stack(0.5)) +
theme(plot.title = element_text(hjust = 0.5),
#axis.text.x = element_text(angle = 45, hjust = 1),
#axis.title.x = element_blank(),
legend.position='none') +
coord_flip() +
scale_fill_manual(values = c("#92c5de", "red")) +
#labs(title="Number of cells in each sample (Singlets)", x ="Samples", y = "Number of Cells")
labs(title=paste0("Data da contagem: ", date_value), x ="Participantes", y = "Numero de respostas")
ggplot(res, aes(reorder(Name, -Counts, sum), Counts, fill=Tipo)) +
geom_col() +
geom_text(
aes(label = stat(y), group = Name),
stat = 'summary', fun.y = sum, hjust = -.5, size = 8
) +
scale_x_continuous(expand = c(.1, .1)) +
#geom_bar(position="stack", stat="identity") +
theme_minimal(base_size = 20) +
geom_text(data=subset(res, Counts != 0), aes(label = Counts), size = 8, position = position_stack(0.5)) +
theme(plot.title = element_text(hjust = 0.5),
#axis.text.x = element_text(angle = 45, hjust = 1),
#axis.title.x = element_blank(),
legend.position='none') +
coord_flip() +
scale_fill_manual(values = c("#92c5de", "red")) +
#labs(title="Number of cells in each sample (Singlets)", x ="Samples", y = "Number of Cells")
labs(title=paste0("Data da contagem: ", date_value), x ="Participantes", y = "Numero de respostas")
##### Rankig
ggplot(res, aes(reorder(Name, -Counts, sum), Counts, fill=Tipo)) +
geom_col() +
geom_text(
aes(label = stat(y), group = Name),
stat = 'summary', fun.y = sum, hjust = -.5, size = 8
) +
scale_x_discrete(expand = c(.1, .1)) +
#geom_bar(position="stack", stat="identity") +
theme_minimal(base_size = 20) +
geom_text(data=subset(res, Counts != 0), aes(label = Counts), size = 8, position = position_stack(0.5)) +
theme(plot.title = element_text(hjust = 0.5),
#axis.text.x = element_text(angle = 45, hjust = 1),
#axis.title.x = element_blank(),
legend.position='none') +
coord_flip() +
scale_fill_manual(values = c("#92c5de", "red")) +
#labs(title="Number of cells in each sample (Singlets)", x ="Samples", y = "Number of Cells")
labs(title=paste0("Data da contagem: ", date_value), x ="Participantes", y = "Numero de respostas")
ggplot(res, aes(reorder(Name, -Counts, sum), Counts, fill=Tipo)) +
geom_col() +
geom_text(
aes(label = stat(y), group = Name),
stat = 'summary', fun.y = sum, hjust = -.5, size = 8
) +
scale_x_discrete(expand = c(.9, .9)) +
#geom_bar(position="stack", stat="identity") +
theme_minimal(base_size = 20) +
geom_text(data=subset(res, Counts != 0), aes(label = Counts), size = 8, position = position_stack(0.5)) +
theme(plot.title = element_text(hjust = 0.5),
#axis.text.x = element_text(angle = 45, hjust = 1),
#axis.title.x = element_blank(),
legend.position='none') +
coord_flip() +
scale_fill_manual(values = c("#92c5de", "red")) +
#labs(title="Number of cells in each sample (Singlets)", x ="Samples", y = "Number of Cells")
labs(title=paste0("Data da contagem: ", date_value), x ="Participantes", y = "Numero de respostas")
##### Rankig
ggplot(res, aes(reorder(Name, -Counts, sum), Counts, fill=Tipo)) +
geom_col() +
geom_text(
aes(label = stat(y), group = Name),
stat = 'summary', fun.y = sum, hjust = -.5, size = 8
) +
scale_x_discrete(expand = c(.0, .9)) +
#geom_bar(position="stack", stat="identity") +
theme_minimal(base_size = 20) +
geom_text(data=subset(res, Counts != 0), aes(label = Counts), size = 8, position = position_stack(0.5)) +
theme(plot.title = element_text(hjust = 0.5),
#axis.text.x = element_text(angle = 45, hjust = 1),
#axis.title.x = element_blank(),
legend.position='none') +
coord_flip() +
scale_fill_manual(values = c("#92c5de", "red")) +
#labs(title="Number of cells in each sample (Singlets)", x ="Samples", y = "Number of Cells")
labs(title=paste0("Data da contagem: ", date_value), x ="Participantes", y = "Numero de respostas")
ggplot(res, aes(reorder(Name, -Counts, sum), Counts, fill=Tipo)) +
geom_col() +
geom_text(
aes(label = stat(y), group = Name),
stat = 'summary', fun.y = sum, hjust = -.5, size = 8
) +
scale_x_discrete(expand = c(.0, -1)) +
#geom_bar(position="stack", stat="identity") +
theme_minimal(base_size = 20) +
geom_text(data=subset(res, Counts != 0), aes(label = Counts), size = 8, position = position_stack(0.5)) +
theme(plot.title = element_text(hjust = 0.5),
#axis.text.x = element_text(angle = 45, hjust = 1),
#axis.title.x = element_blank(),
legend.position='none') +
coord_flip() +
scale_fill_manual(values = c("#92c5de", "red")) +
#labs(title="Number of cells in each sample (Singlets)", x ="Samples", y = "Number of Cells")
labs(title=paste0("Data da contagem: ", date_value), x ="Participantes", y = "Numero de respostas")
##### Rankig
ggplot(res, aes(reorder(Name, -Counts, sum), Counts, fill=Tipo)) +
geom_col() +
geom_text(
aes(label = stat(y), group = Name),
stat = 'summary', fun.y = sum, hjust = -.5, size = 8
) +
scale_x_discrete(expand = c(.0, -3)) +
#geom_bar(position="stack", stat="identity") +
theme_minimal(base_size = 20) +
geom_text(data=subset(res, Counts != 0), aes(label = Counts), size = 8, position = position_stack(0.5)) +
theme(plot.title = element_text(hjust = 0.5),
#axis.text.x = element_text(angle = 45, hjust = 1),
#axis.title.x = element_blank(),
legend.position='none') +
coord_flip() +
scale_fill_manual(values = c("#92c5de", "red")) +
#labs(title="Number of cells in each sample (Singlets)", x ="Samples", y = "Number of Cells")
labs(title=paste0("Data da contagem: ", date_value), x ="Participantes", y = "Numero de respostas")
ggplot(res, aes(reorder(Name, -Counts, sum), Counts, fill=Tipo)) +
geom_col() +
geom_text(
aes(label = stat(y), group = Name),
stat = 'summary', fun.y = sum, hjust = -.5, size = 8
) +
scale_x_discrete(expand = c(-2, -3)) +
#geom_bar(position="stack", stat="identity") +
theme_minimal(base_size = 20) +
geom_text(data=subset(res, Counts != 0), aes(label = Counts), size = 8, position = position_stack(0.5)) +
theme(plot.title = element_text(hjust = 0.5),
#axis.text.x = element_text(angle = 45, hjust = 1),
#axis.title.x = element_blank(),
legend.position='none') +
coord_flip() +
scale_fill_manual(values = c("#92c5de", "red")) +
#labs(title="Number of cells in each sample (Singlets)", x ="Samples", y = "Number of Cells")
labs(title=paste0("Data da contagem: ", date_value), x ="Participantes", y = "Numero de respostas")
##### Rankig
ggplot(res, aes(reorder(Name, -Counts, sum), Counts, fill=Tipo)) +
geom_col() +
geom_text(
aes(label = stat(y), group = Name),
stat = 'summary', fun.y = sum, hjust = -.5, size = 8
) +
#geom_bar(position="stack", stat="identity") +
theme_minimal(base_size = 20) +
geom_text(data=subset(res, Counts != 0), aes(label = Counts), size = 8, position = position_stack(0.5)) +
theme(plot.title = element_text(hjust = 0.5),
#axis.text.x = element_text(angle = 45, hjust = 1),
#axis.title.x = element_blank(),
legend.position='none') +
coord_flip() +
scale_fill_manual(values = c("#92c5de", "red")) +
#labs(title="Number of cells in each sample (Singlets)", x ="Samples", y = "Number of Cells")
labs(title=paste0("Data da contagem: ", date_value), x ="Participantes", y = "Numero de respostas")
ggplot(res, aes(reorder(Name, -Counts, sum), Counts, fill=Tipo)) +
geom_col() +
geom_text(
aes(label = stat(y), group = Name),
stat = 'summary', fun.y = sum, hjust = -.5, size = 8
) +
#geom_bar(position="stack", stat="identity") +
theme_minimal(base_size = 20) +
geom_text(data=subset(res, Counts != 0), aes(label = Counts), size = 8, position = position_stack(0.5)) +
theme(plot.title = element_text(hjust = 0.5),
#axis.text.x = element_text(angle = 45, hjust = 1),
#axis.title.x = element_blank(),
legend.position='none',
plot.margin = unit(c(1,1,1,1), "cm")) +
coord_flip() +
scale_fill_manual(values = c("#92c5de", "red")) +
#labs(title="Number of cells in each sample (Singlets)", x ="Samples", y = "Number of Cells")
labs(title=paste0("Data da contagem: ", date_value), x ="Participantes", y = "Numero de respostas")
ggplot(res, aes(reorder(Name, -Counts, sum), Counts, fill=Tipo)) +
geom_col() +
geom_text(
aes(label = stat(y), group = Name),
stat = 'summary', fun.y = sum, hjust = -.5, size = 8
) +
#geom_bar(position="stack", stat="identity") +
theme_minimal(base_size = 20) +
geom_text(data=subset(res, Counts != 0), aes(label = Counts), size = 8, position = position_stack(0.5)) +
theme(plot.title = element_text(hjust = 0.5),
#axis.text.x = element_text(angle = 45, hjust = 1),
#axis.title.x = element_blank(),
legend.position='none',
plot.margin = unit(c(1,1,1,2), "cm")) +
coord_flip() +
scale_fill_manual(values = c("#92c5de", "red")) +
#labs(title="Number of cells in each sample (Singlets)", x ="Samples", y = "Number of Cells")
labs(title=paste0("Data da contagem: ", date_value), x ="Participantes", y = "Numero de respostas")
ggplot(res, aes(reorder(Name, -Counts, sum), Counts, fill=Tipo)) +
geom_col() +
geom_text(
aes(label = stat(y), group = Name),
stat = 'summary', fun.y = sum, hjust = -.5, size = 8
) +
#geom_bar(position="stack", stat="identity") +
theme_minimal(base_size = 20) +
geom_text(data=subset(res, Counts != 0), aes(label = Counts), size = 8, position = position_stack(0.5)) +
theme(plot.title = element_text(hjust = 0.5),
#axis.text.x = element_text(angle = 45, hjust = 1),
#axis.title.x = element_blank(),
legend.position='none',
plot.margin = unit(c(1,2,1,0), "cm")) +
coord_flip() +
scale_fill_manual(values = c("#92c5de", "red")) +
#labs(title="Number of cells in each sample (Singlets)", x ="Samples", y = "Number of Cells")
labs(title=paste0("Data da contagem: ", date_value), x ="Participantes", y = "Numero de respostas")
ggplot(res, aes(reorder(Name, -Counts, sum), Counts, fill=Tipo)) +
geom_col() +
geom_text(
aes(label = stat(y), group = Name),
stat = 'summary', fun.y = sum, hjust = -.5, size = 8
) +
#geom_bar(position="stack", stat="identity") +
theme_minimal(base_size = 20) +
geom_text(data=subset(res, Counts != 0), aes(label = Counts), size = 8, position = position_stack(0.5)) +
theme(plot.title = element_text(hjust = 0.5),
#axis.text.x = element_text(angle = 45, hjust = 1),
#axis.title.x = element_blank(),
legend.position='none',
plot.margin = unit(c(1,2,2,0), "cm")) +
coord_flip() +
scale_fill_manual(values = c("#92c5de", "red")) +
#labs(title="Number of cells in each sample (Singlets)", x ="Samples", y = "Number of Cells")
labs(title=paste0("Data da contagem: ", date_value), x ="Participantes", y = "Numero de respostas")
##### Rankig
ggplot(res, aes(reorder(Name, -Counts, sum), Counts, fill=Tipo)) +
geom_col() +
geom_text(
aes(label = stat(y), group = Name),
stat = 'summary', fun.y = sum, hjust = -.5, size = 8
) +
#geom_bar(position="stack", stat="identity") +
theme_minimal(base_size = 20) +
geom_text(data=subset(res, Counts != 0), aes(label = Counts), size = 8, position = position_stack(0.5)) +
theme(plot.title = element_text(hjust = 0.5),
#axis.text.x = element_text(angle = 45, hjust = 1),
#axis.title.x = element_blank(),
legend.position='none',
plot.margin = unit(c(1,2,0,0), "cm")) +
coord_flip() +
scale_fill_manual(values = c("#92c5de", "red")) +
#labs(title="Number of cells in each sample (Singlets)", x ="Samples", y = "Number of Cells")
labs(title=paste0("Data da contagem: ", date_value), x ="Participantes", y = "Numero de respostas")
##### Rankig
ggplot(res, aes(reorder(Name, -Counts, sum), Counts, fill=Tipo)) +
geom_col() +
geom_text(
aes(label = stat(y), group = Name),
stat = 'summary', fun.y = sum, hjust = -.5, size = 8
) +
#geom_bar(position="stack", stat="identity") +
theme_minimal(base_size = 20) +
geom_text(data=subset(res, Counts != 0), aes(label = Counts), size = 8, position = position_stack(0.5)) +
theme(plot.title = element_text(hjust = 0.5),
#axis.text.x = element_text(angle = 45, hjust = 1),
#axis.title.x = element_blank(),
legend.position='none',
plot.margin = unit(c(0,0,0,0), "cm")) +
coord_flip() +
scale_fill_manual(values = c("#92c5de", "red")) +
#labs(title="Number of cells in each sample (Singlets)", x ="Samples", y = "Number of Cells")
labs(title=paste0("Data da contagem: ", date_value), x ="Participantes", y = "Numero de respostas")
##### Rankig
ggplot(res, aes(reorder(Name, -Counts, sum), Counts, fill=Tipo)) +
geom_col() +
geom_text(
aes(label = stat(y), group = Name),
stat = 'summary', fun.y = sum, hjust = -.5, size = 8
) +
#geom_bar(position="stack", stat="identity") +
theme_minimal(base_size = 20) +
geom_text(data=subset(res, Counts != 0), aes(label = Counts), size = 8, position = position_stack(0.5)) +
theme(plot.title = element_text(hjust = 0.5),
#axis.text.x = element_text(angle = 45, hjust = 1),
#axis.title.x = element_blank(),
legend.position='none',
plot.margin = unit(c(1,1,1,1), "cm")) +
coord_flip() +
scale_fill_manual(values = c("#92c5de", "red")) +
#labs(title="Number of cells in each sample (Singlets)", x ="Samples", y = "Number of Cells")
labs(title=paste0("Data da contagem: ", date_value), x ="Participantes", y = "Numero de respostas")
##### Rankig
ggplot(res, aes(reorder(Name, Counts, sum), Counts, fill=Tipo)) +
geom_col() +
geom_text(
aes(label = stat(y), group = Name),
stat = 'summary', fun.y = sum, hjust = -.5, size = 8
) +
#geom_bar(position="stack", stat="identity") +
theme_minimal(base_size = 20) +
geom_text(data=subset(res, Counts != 0), aes(label = Counts), size = 8, position = position_stack(0.5)) +
theme(plot.title = element_text(hjust = 0.5),
#axis.text.x = element_text(angle = 45, hjust = 1),
#axis.title.x = element_blank(),
legend.position='none',
plot.margin = unit(c(1,1,1,1), "cm")) +
coord_flip() +
scale_fill_manual(values = c("#92c5de", "red")) +
#labs(title="Number of cells in each sample (Singlets)", x ="Samples", y = "Number of Cells")
labs(title=paste0("Data da contagem: ", date_value), x ="Participantes", y = "Numero de respostas")
## Rankig
ggplot(res, aes(reorder(Name, Counts, sum), Counts, fill=Tipo)) +
geom_col() +
geom_text(
aes(label = stat(y), group = Name),
stat = 'summary', fun.y = sum, hjust = -.5, size = 8
) +
#geom_bar(position="stack", stat="identity") +
theme_minimal(base_size = 20) +
geom_text(data=subset(res, Counts != 0), aes(label = Counts), size = 8, position = position_stack(0.5)) +
theme(plot.title = element_text(hjust = 0.5),
#axis.text.x = element_text(angle = 45, hjust = 1),
#axis.title.x = element_blank(),
#legend.position='none',
plot.margin = unit(c(1,1,1,1), "cm")) +
coord_flip() +
scale_fill_manual(values = c("#92c5de", "red")) +
#labs(title="Number of cells in each sample (Singlets)", x ="Samples", y = "Number of Cells")
labs(title=paste0("Data da contagem: ", date_value), x ="Participantes", y = "Numero de respostas")
ggplot(res, aes(reorder(Name, Counts, sum), Counts, fill=Tipo)) +
geom_col() +
geom_text(
aes(label = stat(y), group = Name),
stat = 'summary', fun.y = sum, hjust = 0, size = 8
) +
#geom_bar(position="stack", stat="identity") +
theme_minimal(base_size = 20) +
geom_text(data=subset(res, Counts != 0), aes(label = Counts), size = 8, position = position_stack(0.5)) +
theme(plot.title = element_text(hjust = 0.5),
#axis.text.x = element_text(angle = 45, hjust = 1),
#axis.title.x = element_blank(),
#legend.position='none',
plot.margin = unit(c(1,1,1,1), "cm")) +
coord_flip() +
scale_fill_manual(values = c("#92c5de", "red")) +
#labs(title="Number of cells in each sample (Singlets)", x ="Samples", y = "Number of Cells")
labs(title=paste0("Data da contagem: ", date_value), x ="Participantes", y = "Numero de respostas")
file = "~/Downloads/Familia Souza - Sheet1.csv"
df = read.csv(file, skip = 1, header = T, stringsAsFactors = F)
df = df[-1,]
head(df)
names = gsub( " .*$", "", df$Name)
counts = apply(df[, c(4:ncol(df))], 1, function(x) sum(x[] != ""))
res = data.frame(Name=names, Counts=counts, Tipo="Respostas")
res = rbind(res, data.frame(Name=names, Counts=df$ExtraPoints, Tipo="Extra"))
date_value = Sys.Date()
date_value = format(date_value, format="%d %B %Y")
##### Rankig
ggplot(res, aes(reorder(Name, Counts, sum), Counts, fill=Tipo)) +
geom_col() +
geom_text(
aes(label = stat(y), group = Name),
stat = 'summary', fun.y = sum, hjust = 0, size = 8
) +
#geom_bar(position="stack", stat="identity") +
theme_minimal(base_size = 20) +
geom_text(data=subset(res, Counts != 0), aes(label = Counts), size = 8, position = position_stack(0.5)) +
theme(plot.title = element_text(hjust = 0.5),
#axis.text.x = element_text(angle = 45, hjust = 1),
#axis.title.x = element_blank(),
#legend.position='none',
plot.margin = unit(c(1,1,1,1), "cm")) +
coord_flip() +
scale_fill_manual(values = c("#92c5de", "red")) +
#labs(title="Number of cells in each sample (Singlets)", x ="Samples", y = "Number of Cells")
labs(title=paste0("Data da contagem: ", date_value), x ="Participantes", y = "Numero de respostas")
res
file = "~/Downloads/Familia Souza - Sheet1.csv"
df = read.csv(file, skip = 1, header = T, stringsAsFactors = F)
df = df[-1,]
head(df)
names = gsub( " .*$", "", df$Name)
counts = apply(df[, c(4:ncol(df))], 1, function(x) sum(x[] != ""))
counts
file = "~/Downloads/Familia Souza - Sheet1.csv"
df = read.csv(file, skip = 1, header = T, stringsAsFactors = F)
df = df[-1,]
head(df)
dim(df)
names = gsub( " .*$", "", df$Name)
counts = apply(df[, c(4:ncol(df))], 1, function(x) sum(x[] != ""))
res = data.frame(Name=names, Counts=counts, Tipo="Respostas")
res = rbind(res, data.frame(Name=names, Counts=df$ExtraPoints, Tipo="Extra"))
res
date_value = Sys.Date()
date_value = format(date_value, format="%d %B %Y")
##### Rankig
ggplot(res, aes(reorder(Name, Counts, sum), Counts, fill=Tipo)) +
geom_col() +
geom_text(
aes(label = stat(y), group = Name),
stat = 'summary', fun.y = sum, hjust = 0, size = 8
) +
#geom_bar(position="stack", stat="identity") +
theme_minimal(base_size = 20) +
geom_text(data=subset(res, Counts != 0), aes(label = Counts), size = 8, position = position_stack(0.5)) +
theme(plot.title = element_text(hjust = 0.5),
#axis.text.x = element_text(angle = 45, hjust = 1),
#axis.title.x = element_blank(),
#legend.position='none',
plot.margin = unit(c(1,1,1,1), "cm")) +
coord_flip() +
scale_fill_manual(values = c("#92c5de", "red")) +
#labs(title="Number of cells in each sample (Singlets)", x ="Samples", y = "Number of Cells")
labs(title=paste0("Data da contagem: ", date_value), x ="Participantes", y = "Numero de respostas")
#############  PIZZA  ###################
